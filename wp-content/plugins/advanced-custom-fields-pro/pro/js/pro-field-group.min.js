!function(e){acf.field_group_pro={init:function(){var e=this;acf.add_action("open_field sortstop",function(t){e.update_field_parent(t)}),acf.add_action("duplicate_field",function(t){e.duplicate_field(t)}),acf.add_action("delete_field",function(t){e.delete_field(t)}),acf.add_action("change_field_type",function(t){e.change_field_type(t)}),acf.add_action("open_field change_field_type",function(t){e.toggle_column_width(t)}),this.repeater.init(),this.flexible_content.init()},fix_conditional_logic:function(t){var a={};t.each(function(){a[e(this).attr("data-orig")]=e(this).attr("data-key")}),t.find(".conditional-logic-field").each(function(){var t=e(this).val();t in a&&(e(this).find('option[value="'+a[t]+'"]').exists()||e(this).append('<option value="'+a[t]+'">'+a[t]+"</option>"),e(this).val(a[t]))})},update_field_parent:function(e){if(e.hasClass("field")){var t=e.parent().closest(".field"),a=0;if(t.exists()){var i=t.attr("data-id"),f=t.attr("data-key");a=f,i&&(a=i)}acf.field_group.update_field_meta(e,"parent",a),acf.do_action("update_field_parent",e,t)}},toggle_column_width:function(e){var t=e.parent().closest(".field");$column_width=e.find('> .field-settings > table > tbody > tr[data-name="column_width"]'),t.exists()?$column_width.find("input").removeAttr("disabled"):$column_width.find("input").attr("disabled","disabled")},duplicate_field:function(t){var a=t.find(".field").not('[data-key="acfcloneindex"]');a.exists()&&(a.each(function(){var t=e(this).parent().closest(".field"),a=acf.field_group.get_field_meta(t,"key");acf.field_group.wipe_field(e(this)),acf.field_group.update_field_meta(e(this),"parent",a),acf.field_group.save_field(e(this))}),this.fix_conditional_logic(a))},delete_field:function(t){t.find(".field").each(function(){acf.field_group.delete_field(e(this),!1)})},change_field_type:function(t){t.find(".field").each(function(){acf.field_group.delete_field(e(this),!1)})}},acf.field_group_pro.repeater={init:function(){var t=this;acf.add_action("open_field change_field_type",function(e){t.render_field(e)}),e(document).on("change",".acf-repeater-layout input",function(){t.render_field(e(this).closest(".field"))})},render_field:function(e){if("repeater"==e.attr("data-type")){var t=e.find("> .field-settings > table > tbody"),a=t.find('> [data-name="sub_fields"] .acf-field-list:first'),i=t.find('> [data-name="layout"] input:checked').val();a.removeClass("layout-row layout-table").addClass("layout-"+i),a.hasClass("ui-sortable")||acf.field_group.sort_fields(a)}}},acf.field_group_pro.flexible_content={init:function(){var t=this;acf.add_action("open_field change_field_type",function(e){t.render_field(e)}),acf.add_action("update_field_parent",function(e,a){t.update_field_parent(e,a)}),e(document).on("click",'[data-name="acf-fc-add"]',function(a){a.preventDefault(),t.add_layout(e(this).closest(".acf-field"))}),e(document).on("click",'[data-name="acf-fc-duplicate"]',function(a){a.preventDefault(),t.duplicate_layout(e(this).closest(".acf-field"))}),e(document).on("click",'[data-name="acf-fc-delete"]',function(a){a.preventDefault(),t.delete_layout(e(this).closest(".acf-field"))}),e(document).on("blur",".acf-fc-meta-label input",function(a){t.change_layout_label(e(this))}),e(document).on("change",".acf-fc-meta-display select",function(a){t.render_layout(e(this).closest(".acf-field"))})},add_layout:function(t){var a=t.clone(!1);a.find(".field").not('[data-key="acfcloneindex"]').remove(),a.find(".no-fields-message").show(),a.find(".acf-fc-meta input").val(""),this.wipe_layout(a),t.after(a),a.find(".acf-field-list").each(function(){acf.field_group.sort_fields(e(this))}),a.find(".acf-fc-meta select").val("row").trigger("change")},wipe_layout:function(t){var a=t.attr("data-key"),i=acf.get_uniqid();t.attr("data-key",i),t.find('> .acf-input > .acf-hidden [data-name="layout-key"]').val(i),t.find('[id*="'+a+'"]').each(function(){e(this).attr("id",e(this).attr("id").replace("-layouts-"+a+"-","-layouts-"+i+"-"))}),t.find('[name*="'+a+'"]').each(function(){e(this).attr("name",e(this).attr("name").replace("[layouts]["+a+"]","[layouts]["+i+"]"))})},duplicate_layout:function(t){acf.do_action("before_duplicate",t);var a=t.clone(!1);this.wipe_layout(a);var i=a.attr("data-key"),f=a.find(".field").not('[data-key="acfcloneindex"]');f.each(function(){acf.field_group.wipe_field(e(this)),acf.field_group.update_field_meta(e(this),"parent_layout",i),acf.field_group.save_field(e(this))}),t.after(a),acf.do_action("after_duplicate",t,a),acf.field_group_pro.fix_conditional_logic(f),a.find(".acf-field-list").each(function(){acf.field_group.sort_fields(e(this))}),a.find(".acf-fc-meta-label input").focus()},delete_layout:function(t){return 0==t.siblings('tr[data-name="fc_layout"]').length?(alert(acf._e("flexible_content","layout_warning")),!1):(t.find(".field").not('[data-key="acfcloneindex"]').each(function(){acf.field_group.delete_field(e(this),!1)}),acf.field_group.save_field(t.closest(".field")),void acf.remove_tr(t))},change_layout_label:function(t){var a=t.closest(".acf-fc-meta").find(".acf-fc-meta-name input");if(""==a.val()){var i=t.val(),f={ä:"a",æ:"a",å:"a",ö:"o",ø:"o",é:"e",ë:"e",ü:"u",ó:"o",ő:"o",ú:"u",é:"e",á:"a",ű:"u",í:"i"," ":"_","'":"","\\?":""};e.each(f,function(e,t){var a=new RegExp(e,"g");i=i.replace(a,t)}),i=i.toLowerCase(),a.val(i).trigger("change")}},render_field:function(t){if("flexible_content"==t.attr("data-type")){var a=this,i=t.find("> .field-settings > table > tbody");i.hasClass("ui-sortable")||i.sortable({items:'> tr[data-name="fc_layout"]',handle:'[data-name="acf-fc-reorder"]',forceHelperSize:!0,forcePlaceholderSize:!0,scroll:!0,start:function(e,t){acf.do_action("sortstart",t.item,t.placeholder)},stop:function(e,a){acf.do_action("sortstop",a.item,a.placeholder),acf.field_group.save_field(t)}}),i.children('tr[data-name="fc_layout"]').each(function(){a.render_layout(e(this))})}},render_layout:function(t){var a=t.find(".acf-fc-meta:first .acf-fc-meta-display select").val(),i=t.find(".acf-field-list:first");i.removeClass("layout-row layout-table").addClass("layout-"+a),i.hasClass("ui-sortable")||acf.field_group.sort_fields(i);var f=t.attr("data-key");i.children(".field").each(function(){acf.field_group.update_field_meta(e(this),"parent_layout",f)})},update_field_parent:function(e,t){if(!t.exists())return void acf.field_group.delete_field_meta(e,"parent_layout");var a=e.closest("tr.acf-field");if("fc_layout"==a.attr("data-name")){var i=acf.field_group.get_field_meta(e,"parent_layout"),f=a.attr("data-key");i!=f&&(acf.field_group.update_field_meta(e,"parent_layout",f),acf.field_group.save_field(e))}}},acf.add_action("ready",function(){acf.field_group_pro.init()})}(jQuery);
